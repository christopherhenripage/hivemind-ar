<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Queen Freret XIV — Shannon E Thomas | Charity Gallery</title>
  <meta name="description" content="8 original paintings by Shannon E Thomas benefiting Son of a Saint. View in AR and place your bid before February 17, 2026.">
  <meta name="keywords" content="Shannon E Thomas, Queen Freret XIV, Son of a Saint, charity auction, AR art gallery, New Orleans art">
  <link rel="canonical" href="https://hivemindar.com/charity/shannon-thomas">

  <!-- Open Graph -->
  <meta property="og:title" content="Queen Freret XIV — Shannon E Thomas">
  <meta property="og:description" content="8 original paintings benefiting Son of a Saint. View in AR and place your bid.">
  <meta property="og:image" content="https://hivemindar.com/images/charity/shannon-thomas/clair.jpg">
  <meta property="og:url" content="https://hivemindar.com/charity/shannon-thomas">
  <meta property="og:type" content="website">

  <!-- Twitter Card -->
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:title" content="Queen Freret XIV — Shannon E Thomas">
  <meta name="twitter:description" content="8 original paintings benefiting Son of a Saint. View in AR and place your bid.">
  <meta name="twitter:image" content="https://hivemindar.com/images/charity/shannon-thomas/clair.jpg">

  <!-- Favicon -->
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16.png">
  <link rel="manifest" href="/manifest.json">

  <link rel="stylesheet" href="/styles/hivemind.css">

  <!-- Model-Viewer for AR -->
  <script type="module" src="https://cdn.jsdelivr.net/npm/@google/model-viewer@3.3.0/dist/model-viewer.min.js"></script>
  <script type="module">
    if (!customElements.get('model-viewer')) {
      const script = document.createElement('script');
      script.type = 'module';
      script.src = 'https://unpkg.com/@google/model-viewer/dist/model-viewer.min.js';
      document.head.appendChild(script);
    }
  </script>

  <!-- JSON-LD Structured Data -->
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "ItemList",
    "name": "Queen Freret XIV — A Collection by Shannon E Thomas",
    "description": "8 original paintings benefiting Son of a Saint",
    "numberOfItems": 8,
    "itemListElement": [
      {
        "@type": "VisualArtwork",
        "position": 1,
        "name": "Clair",
        "artist": { "@type": "Person", "name": "Shannon E Thomas" },
        "artMedium": "Hand-painted on canvas",
        "width": { "@type": "Distance", "name": "28 inches" },
        "height": { "@type": "Distance", "name": "38 inches" }
      },
      {
        "@type": "VisualArtwork",
        "position": 2,
        "name": "Fleur",
        "artist": { "@type": "Person", "name": "Shannon E Thomas" },
        "artMedium": "Hand-painted on canvas",
        "width": { "@type": "Distance", "name": "28 inches" },
        "height": { "@type": "Distance", "name": "38 inches" }
      },
      {
        "@type": "VisualArtwork",
        "position": 3,
        "name": "Koda",
        "artist": { "@type": "Person", "name": "Shannon E Thomas" },
        "artMedium": "Hand-painted on canvas",
        "width": { "@type": "Distance", "name": "28 inches" },
        "height": { "@type": "Distance", "name": "38 inches" }
      },
      {
        "@type": "VisualArtwork",
        "position": 4,
        "name": "Lane",
        "artist": { "@type": "Person", "name": "Shannon E Thomas" },
        "artMedium": "Hand-painted on canvas",
        "width": { "@type": "Distance", "name": "28 inches" },
        "height": { "@type": "Distance", "name": "38 inches" }
      },
      {
        "@type": "VisualArtwork",
        "position": 5,
        "name": "Lilac",
        "artist": { "@type": "Person", "name": "Shannon E Thomas" },
        "artMedium": "Hand-painted on canvas",
        "width": { "@type": "Distance", "name": "28 inches" },
        "height": { "@type": "Distance", "name": "38 inches" }
      },
      {
        "@type": "VisualArtwork",
        "position": 6,
        "name": "Revel",
        "artist": { "@type": "Person", "name": "Shannon E Thomas" },
        "artMedium": "Hand-painted on canvas",
        "width": { "@type": "Distance", "name": "28 inches" },
        "height": { "@type": "Distance", "name": "38 inches" }
      },
      {
        "@type": "VisualArtwork",
        "position": 7,
        "name": "Roux",
        "artist": { "@type": "Person", "name": "Shannon E Thomas" },
        "artMedium": "Hand-painted on canvas",
        "width": { "@type": "Distance", "name": "28 inches" },
        "height": { "@type": "Distance", "name": "38 inches" }
      },
      {
        "@type": "VisualArtwork",
        "position": 8,
        "name": "Vesper",
        "artist": { "@type": "Person", "name": "Shannon E Thomas" },
        "artMedium": "Hand-painted on canvas",
        "width": { "@type": "Distance", "name": "28 inches" },
        "height": { "@type": "Distance", "name": "38 inches" }
      }
    ]
  }
  </script>

  <style>
    /* Hero Section */
    .charity-hero {
      background: #000;
      padding: 6rem 2rem 4rem;
      text-align: center;
      color: #fff;
      position: relative;
      overflow: hidden;
    }

    .charity-hero::before {
      content: '';
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      width: 400px;
      height: 400px;
      background: radial-gradient(circle, rgba(128, 60, 180, 0.15) 0%, transparent 70%);
      border-radius: 50%;
      animation: heroGlow 4s ease-in-out infinite alternate;
      pointer-events: none;
    }

    @keyframes heroGlow {
      0% { opacity: 0.5; transform: translate(-50%, -50%) scale(0.9); }
      100% { opacity: 1; transform: translate(-50%, -50%) scale(1.1); }
    }

    .charity-hero h1 {
      font-size: 3rem;
      margin: 0 0 0.5rem;
      font-weight: 700;
      letter-spacing: 0.02em;
      position: relative;
    }

    .charity-hero .subtitle {
      font-size: 1.25rem;
      opacity: 0.8;
      margin: 0 0 1rem;
      font-weight: 300;
    }

    .charity-hero .charity-line {
      font-size: 1rem;
      opacity: 0.7;
      margin: 0 0 0.75rem;
    }

    .charity-hero .auction-date {
      font-size: 0.95rem;
      color: #c9a227;
      margin: 0 0 1.25rem;
      font-weight: 500;
    }

    .charity-hero .hero-ar-note {
      font-size: 0.95rem;
      color: rgba(255, 255, 255, 0.7);
      max-width: 480px;
      margin: 0 auto 2rem;
      line-height: 1.6;
    }

    .charity-hero .btn-auction {
      display: inline-block;
      padding: 0.875rem 2rem;
      background: linear-gradient(135deg, #803cb4 0%, #6a2c9a 100%);
      color: #fff;
      text-decoration: none;
      border-radius: 8px;
      font-weight: 600;
      font-size: 1rem;
      transition: transform 0.2s, box-shadow 0.2s;
    }

    .charity-hero .btn-auction:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 20px rgba(128, 60, 180, 0.4);
    }

    /* Charity Info Banner */
    .charity-info {
      background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
      color: #fff;
      padding: 2rem;
      text-align: center;
    }

    .charity-info p {
      margin: 0.5rem 0;
      font-size: 0.95rem;
      opacity: 0.9;
      line-height: 1.6;
    }

    .charity-info a {
      color: #c9a227;
      text-decoration: underline;
    }

    .charity-info a:hover {
      color: #e0b830;
    }

    .charity-info .dimensions-note {
      opacity: 0.7;
      font-size: 0.875rem;
    }

    /* Artwork Grid */
    .gallery-container {
      max-width: 1400px;
      margin: 0 auto;
      padding: 3rem 2rem;
    }

    .artwork-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(340px, 1fr));
      gap: 2rem;
    }

    .artwork-card {
      background: #fff;
      border-radius: 12px;
      overflow: hidden;
      box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08);
      transition: transform 0.3s, box-shadow 0.3s;
      display: flex;
      flex-direction: column;
    }

    .artwork-card:hover {
      transform: translateY(-4px);
      box-shadow: 0 8px 30px rgba(0, 0, 0, 0.15);
    }

    .artwork-card-wrapper {
      position: relative;
      width: 100%;
      background: #f5f5f5;
    }

    .artwork-card-wrapper model-viewer {
      width: 100%;
      height: 400px;
      display: block;
      --poster-color: transparent;
    }

    /* Frame Selector - Compact inline */
    .frame-selector-compact {
      position: absolute;
      bottom: 70px;
      left: 50%;
      transform: translateX(-50%);
      background: rgba(255, 255, 255, 0.95);
      backdrop-filter: blur(10px);
      border-radius: 12px;
      padding: 0.5rem;
      display: flex;
      gap: 0.5rem;
      box-shadow: 0 4px 20px rgba(0, 0, 0, 0.15);
      z-index: 5;
      opacity: 0;
      pointer-events: none;
      transition: opacity 0.3s, bottom 0.3s;
    }

    .artwork-card-wrapper:hover .frame-selector-compact {
      opacity: 1;
      pointer-events: all;
      bottom: 75px;
    }

    .frame-btn {
      width: 40px;
      height: 40px;
      border-radius: 8px;
      border: 3px solid transparent;
      cursor: pointer;
      background: #f5f5f5;
      position: relative;
      transition: border-color 0.2s, transform 0.2s;
      padding: 0;
      font-size: 0;
      color: transparent;
      overflow: hidden;
    }

    .frame-btn:hover {
      transform: scale(1.1);
    }

    .frame-btn.selected {
      border-color: #803cb4;
      box-shadow: 0 0 0 2px rgba(128, 60, 180, 0.3);
    }

    .frame-btn::before {
      content: '';
      position: absolute;
      top: 4px;
      left: 4px;
      right: 4px;
      bottom: 4px;
      border-radius: 3px;
    }

    .frame-btn.no-frame::before { border: 2px dashed #ccc; background: white; }
    .frame-btn.wood-frame::before { border: 4px solid #8B4513; background: #A0522D; }
    .frame-btn.black-frame::before { border: 4px solid #1a1a1a; background: #333; }
    .frame-btn.gold-frame::before { border: 4px solid #C9A227; background: #D4AF37; box-shadow: 0 0 5px rgba(201, 162, 39, 0.5); }
    .frame-btn.white-frame::before { border: 4px solid #f8f8f8; background: #fff; }
    .frame-btn.silver-frame::before { border: 4px solid #c0c0c0; background: #d0d0d0; }

    /* AR Button */
    .custom-ar-button {
      position: absolute;
      bottom: 16px;
      left: 50%;
      transform: translateX(-50%);
      background: linear-gradient(135deg, #803cb4 0%, #6a2c9a 100%);
      color: white;
      border: none;
      padding: 10px 24px;
      border-radius: 25px;
      font-weight: 600;
      font-size: 0.875rem;
      cursor: pointer;
      z-index: 4;
      transition: all 0.3s ease;
      white-space: nowrap;
    }

    .custom-ar-button:hover {
      transform: translateX(-50%) translateY(-2px);
      box-shadow: 0 4px 15px rgba(128, 60, 180, 0.4);
    }

    .custom-ar-button.pulse {
      animation: arPulse 2s ease-in-out infinite;
    }

    @keyframes arPulse {
      0%, 100% { box-shadow: 0 0 0 0 rgba(128, 60, 180, 0.4); }
      50% { box-shadow: 0 0 0 8px rgba(128, 60, 180, 0); }
    }

    .custom-ar-button.desktop-mode {
      position: relative;
    }

    .ar-desktop-tooltip {
      display: none;
      position: absolute;
      bottom: calc(100% + 8px);
      left: 50%;
      transform: translateX(-50%);
      background: rgba(0, 0, 0, 0.9);
      color: white;
      padding: 8px 12px;
      border-radius: 6px;
      font-size: 12px;
      white-space: nowrap;
    }

    .custom-ar-button.desktop-mode:hover .ar-desktop-tooltip {
      display: block;
    }

    /* AR Badge */
    .ar-badge {
      display: inline-block;
      background: linear-gradient(135deg, #803cb4, #6a2c9a);
      color: white;
      padding: 3px 10px;
      border-radius: 12px;
      font-size: 0.75rem;
      font-weight: 600;
      margin-bottom: 0.5rem;
    }

    /* Artwork Info */
    .artwork-info {
      padding: 1.25rem;
      flex: 1;
    }

    .artwork-info h3 {
      font-size: 1.25rem;
      margin: 0 0 0.5rem;
      color: #1a1a1a;
    }

    .artwork-meta {
      display: flex;
      justify-content: space-between;
      align-items: center;
      font-size: 0.875rem;
      color: #666;
      margin-top: 0.5rem;
    }

    /* Bid Button */
    .artwork-actions {
      padding: 0 1.25rem 1.25rem;
    }

    .btn-bid {
      display: block;
      width: 100%;
      padding: 0.75rem;
      background: linear-gradient(135deg, #803cb4 0%, #6a2c9a 100%);
      color: #fff;
      border: none;
      border-radius: 8px;
      font-weight: 600;
      font-size: 0.95rem;
      cursor: pointer;
      text-align: center;
      text-decoration: none;
      transition: transform 0.2s, box-shadow 0.2s;
    }

    .btn-bid:hover {
      transform: translateY(-2px);
      box-shadow: 0 4px 15px rgba(128, 60, 180, 0.3);
      color: #fff;
    }

    /* CTA Section */
    .charity-cta {
      background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
      color: #fff;
      padding: 4rem 2rem;
      text-align: center;
    }

    .charity-cta h2 {
      font-size: 2rem;
      margin: 0 0 1rem;
    }

    .charity-cta p {
      opacity: 0.8;
      margin: 0 0 2rem;
      font-size: 1.05rem;
    }

    .cta-buttons {
      display: flex;
      gap: 1rem;
      justify-content: center;
      flex-wrap: wrap;
    }

    .cta-buttons a {
      display: inline-block;
      padding: 0.875rem 2rem;
      border-radius: 8px;
      font-weight: 600;
      text-decoration: none;
      transition: transform 0.2s, box-shadow 0.2s;
    }

    .cta-buttons a:hover {
      transform: translateY(-2px);
    }

    .cta-buttons .btn-primary {
      background: linear-gradient(135deg, #803cb4 0%, #6a2c9a 100%);
      color: #fff;
    }

    .cta-buttons .btn-primary:hover {
      box-shadow: 0 6px 20px rgba(128, 60, 180, 0.4);
    }

    .cta-buttons .btn-outline {
      background: transparent;
      color: #fff;
      border: 2px solid rgba(255, 255, 255, 0.4);
    }

    .cta-buttons .btn-outline:hover {
      border-color: #fff;
      box-shadow: 0 6px 20px rgba(255, 255, 255, 0.1);
    }

    /* Hosted by line */
    .hosted-by {
      font-size: 0.8rem;
      opacity: 0.5;
      margin-top: 1rem;
    }

    .hosted-by a {
      color: inherit;
      text-decoration: none;
      opacity: 0.8;
    }

    .hosted-by a:hover {
      opacity: 1;
      text-decoration: underline;
    }

    /* Responsive */
    @media (max-width: 768px) {
      .charity-hero {
        padding: 5rem 1.5rem 3rem;
      }

      .charity-hero h1 {
        font-size: 2rem;
      }

      .charity-hero .subtitle {
        font-size: 1rem;
      }

      .artwork-grid {
        grid-template-columns: 1fr;
        gap: 1.5rem;
      }

      .artwork-card-wrapper model-viewer {
        height: 320px;
      }

      .frame-selector-compact {
        opacity: 1;
        pointer-events: all;
        bottom: 65px;
      }
    }
  </style>
</head>
<body>
  <!-- Navigation -->
  <nav class="public-nav">
    <a href="/" class="logo">
      <img src="https://media.hivemindar.com/images/common/mini_hivemind_logo_white.png" alt="HiveMind AR">
    </a>
    <div class="nav-links" id="navLinks">
      <a href="https://www.32auctions.com/organizations/135580/auctions/194605" target="_blank" rel="noopener" onclick="trackEvent('bid_click', 'nav_auction')">View Auction</a>
    </div>
  </nav>

  <!-- Hero Section -->
  <section class="charity-hero">
    <h1>Queen Freret XIV</h1>
    <p class="subtitle">A Collection by Shannon E Thomas</p>
    <p class="charity-line">8 Original Paintings Benefiting Son of a Saint</p>
    <p class="auction-date">Auction ends February 17, 2026</p>
    <p class="hero-ar-note">View each painting in augmented reality — see it on your wall, at true scale, directly from your phone. No app required.</p>
    <a href="https://www.32auctions.com/organizations/135580/auctions/194605" target="_blank" rel="noopener" class="btn-auction" onclick="trackEvent('bid_click', 'auction_main')">View Full Auction</a>
  </section>

  <!-- Charity Info Banner -->
  <section class="charity-info">
    <p>All proceeds from these paintings benefit <a href="https://sonofasaint.org" target="_blank" rel="noopener">Son of a Saint</a>, a New Orleans nonprofit mentoring fatherless boys.</p>
    <p class="dimensions-note">Each painting: 28" x 38" | Hand-painted on canvas</p>
  </section>

  <!-- Artwork Grid -->
  <div class="gallery-container">
    <div class="artwork-grid" id="artworkGrid">

      <!-- Clair -->
      <div class="artwork-card">
        <div class="artwork-card-wrapper" data-artwork-name="Clair" data-width-inches="28" data-height-inches="38">
          <model-viewer
            src="/models/charity/clair.glb"
            poster="/images/charity/shannon-thomas/clair.jpg"
            ar
            ar-modes="webxr scene-viewer quick-look"
            ar-scale="fixed"
            camera-controls
            touch-action="pan-y"
            shadow-intensity="0.3"
            exposure="1.1"
            loading="lazy"
            data-base-glb="/models/charity/clair.glb">
          </model-viewer>
          <div class="frame-selector-compact">
            <button class="frame-btn no-frame selected" data-frame="none" onclick="selectFrameCompact(this, 'clair', 'none')" title="No Frame"></button>
            <button class="frame-btn wood-frame" data-frame="wood" onclick="selectFrameCompact(this, 'clair', 'wood')" title="Wood Frame">Wood</button>
            <button class="frame-btn black-frame" data-frame="black" onclick="selectFrameCompact(this, 'clair', 'black')" title="Black Frame">Black</button>
            <button class="frame-btn gold-frame" data-frame="gold" onclick="selectFrameCompact(this, 'clair', 'gold')" title="Gold Frame">Gold</button>
            <button class="frame-btn white-frame" data-frame="white" onclick="selectFrameCompact(this, 'clair', 'white')" title="White Frame">White</button>
            <button class="frame-btn silver-frame" data-frame="silver" onclick="selectFrameCompact(this, 'clair', 'silver')" title="Silver Frame">Silver</button>
          </div>
          <button class="custom-ar-button pulse" onclick="activateAR(this)">View in AR</button>
        </div>
        <div class="artwork-info">
          <span class="ar-badge">AR Ready</span>
          <h3>Clair</h3>
          <div class="artwork-meta">
            <span>Hand-painted on canvas</span>
            <span>28" x 38"</span>
          </div>
        </div>
        <div class="artwork-actions">
          <a href="https://www.32auctions.com/organizations/135580/auctions/194605/auction_items/6691651" target="_blank" rel="noopener" class="btn-bid" onclick="trackEvent('bid_click', 'Clair')">Place a Bid</a>
        </div>
      </div>

      <!-- Fleur -->
      <div class="artwork-card">
        <div class="artwork-card-wrapper" data-artwork-name="Fleur" data-width-inches="28" data-height-inches="38">
          <model-viewer
            src="/models/charity/fleur.glb"
            poster="/images/charity/shannon-thomas/fleur.jpg"
            ar
            ar-modes="webxr scene-viewer quick-look"
            ar-scale="fixed"
            camera-controls
            touch-action="pan-y"
            shadow-intensity="0.3"
            exposure="1.1"
            loading="lazy"
            data-base-glb="/models/charity/fleur.glb">
          </model-viewer>
          <div class="frame-selector-compact">
            <button class="frame-btn no-frame selected" data-frame="none" onclick="selectFrameCompact(this, 'fleur', 'none')" title="No Frame"></button>
            <button class="frame-btn wood-frame" data-frame="wood" onclick="selectFrameCompact(this, 'fleur', 'wood')" title="Wood Frame">Wood</button>
            <button class="frame-btn black-frame" data-frame="black" onclick="selectFrameCompact(this, 'fleur', 'black')" title="Black Frame">Black</button>
            <button class="frame-btn gold-frame" data-frame="gold" onclick="selectFrameCompact(this, 'fleur', 'gold')" title="Gold Frame">Gold</button>
            <button class="frame-btn white-frame" data-frame="white" onclick="selectFrameCompact(this, 'fleur', 'white')" title="White Frame">White</button>
            <button class="frame-btn silver-frame" data-frame="silver" onclick="selectFrameCompact(this, 'fleur', 'silver')" title="Silver Frame">Silver</button>
          </div>
          <button class="custom-ar-button pulse" onclick="activateAR(this)">View in AR</button>
        </div>
        <div class="artwork-info">
          <span class="ar-badge">AR Ready</span>
          <h3>Fleur</h3>
          <div class="artwork-meta">
            <span>Hand-painted on canvas</span>
            <span>28" x 38"</span>
          </div>
        </div>
        <div class="artwork-actions">
          <a href="https://www.32auctions.com/organizations/135580/auctions/194605/auction_items/6691644" target="_blank" rel="noopener" class="btn-bid" onclick="trackEvent('bid_click', 'Fleur')">Place a Bid</a>
        </div>
      </div>

      <!-- Koda -->
      <div class="artwork-card">
        <div class="artwork-card-wrapper" data-artwork-name="Koda" data-width-inches="28" data-height-inches="38">
          <model-viewer
            src="/models/charity/koda.glb"
            poster="/images/charity/shannon-thomas/koda.jpg"
            ar
            ar-modes="webxr scene-viewer quick-look"
            ar-scale="fixed"
            camera-controls
            touch-action="pan-y"
            shadow-intensity="0.3"
            exposure="1.1"
            loading="lazy"
            data-base-glb="/models/charity/koda.glb">
          </model-viewer>
          <div class="frame-selector-compact">
            <button class="frame-btn no-frame selected" data-frame="none" onclick="selectFrameCompact(this, 'koda', 'none')" title="No Frame"></button>
            <button class="frame-btn wood-frame" data-frame="wood" onclick="selectFrameCompact(this, 'koda', 'wood')" title="Wood Frame">Wood</button>
            <button class="frame-btn black-frame" data-frame="black" onclick="selectFrameCompact(this, 'koda', 'black')" title="Black Frame">Black</button>
            <button class="frame-btn gold-frame" data-frame="gold" onclick="selectFrameCompact(this, 'koda', 'gold')" title="Gold Frame">Gold</button>
            <button class="frame-btn white-frame" data-frame="white" onclick="selectFrameCompact(this, 'koda', 'white')" title="White Frame">White</button>
            <button class="frame-btn silver-frame" data-frame="silver" onclick="selectFrameCompact(this, 'koda', 'silver')" title="Silver Frame">Silver</button>
          </div>
          <button class="custom-ar-button pulse" onclick="activateAR(this)">View in AR</button>
        </div>
        <div class="artwork-info">
          <span class="ar-badge">AR Ready</span>
          <h3>Koda</h3>
          <div class="artwork-meta">
            <span>Hand-painted on canvas</span>
            <span>28" x 38"</span>
          </div>
        </div>
        <div class="artwork-actions">
          <a href="https://www.32auctions.com/organizations/135580/auctions/194605/auction_items/6691641" target="_blank" rel="noopener" class="btn-bid" onclick="trackEvent('bid_click', 'Koda')">Place a Bid</a>
        </div>
      </div>

      <!-- Lane -->
      <div class="artwork-card">
        <div class="artwork-card-wrapper" data-artwork-name="Lane" data-width-inches="28" data-height-inches="38">
          <model-viewer
            src="/models/charity/lane.glb"
            poster="/images/charity/shannon-thomas/lane.jpg"
            ar
            ar-modes="webxr scene-viewer quick-look"
            ar-scale="fixed"
            camera-controls
            touch-action="pan-y"
            shadow-intensity="0.3"
            exposure="1.1"
            loading="lazy"
            data-base-glb="/models/charity/lane.glb">
          </model-viewer>
          <div class="frame-selector-compact">
            <button class="frame-btn no-frame selected" data-frame="none" onclick="selectFrameCompact(this, 'lane', 'none')" title="No Frame"></button>
            <button class="frame-btn wood-frame" data-frame="wood" onclick="selectFrameCompact(this, 'lane', 'wood')" title="Wood Frame">Wood</button>
            <button class="frame-btn black-frame" data-frame="black" onclick="selectFrameCompact(this, 'lane', 'black')" title="Black Frame">Black</button>
            <button class="frame-btn gold-frame" data-frame="gold" onclick="selectFrameCompact(this, 'lane', 'gold')" title="Gold Frame">Gold</button>
            <button class="frame-btn white-frame" data-frame="white" onclick="selectFrameCompact(this, 'lane', 'white')" title="White Frame">White</button>
            <button class="frame-btn silver-frame" data-frame="silver" onclick="selectFrameCompact(this, 'lane', 'silver')" title="Silver Frame">Silver</button>
          </div>
          <button class="custom-ar-button pulse" onclick="activateAR(this)">View in AR</button>
        </div>
        <div class="artwork-info">
          <span class="ar-badge">AR Ready</span>
          <h3>Lane</h3>
          <div class="artwork-meta">
            <span>Hand-painted on canvas</span>
            <span>28" x 38"</span>
          </div>
        </div>
        <div class="artwork-actions">
          <a href="https://www.32auctions.com/organizations/135580/auctions/194605/auction_items/6691650" target="_blank" rel="noopener" class="btn-bid" onclick="trackEvent('bid_click', 'Lane')">Place a Bid</a>
        </div>
      </div>

      <!-- Lilac -->
      <div class="artwork-card">
        <div class="artwork-card-wrapper" data-artwork-name="Lilac" data-width-inches="28" data-height-inches="38">
          <model-viewer
            src="/models/charity/lilac.glb"
            poster="/images/charity/shannon-thomas/lilac.jpg"
            ar
            ar-modes="webxr scene-viewer quick-look"
            ar-scale="fixed"
            camera-controls
            touch-action="pan-y"
            shadow-intensity="0.3"
            exposure="1.1"
            loading="lazy"
            data-base-glb="/models/charity/lilac.glb">
          </model-viewer>
          <div class="frame-selector-compact">
            <button class="frame-btn no-frame selected" data-frame="none" onclick="selectFrameCompact(this, 'lilac', 'none')" title="No Frame"></button>
            <button class="frame-btn wood-frame" data-frame="wood" onclick="selectFrameCompact(this, 'lilac', 'wood')" title="Wood Frame">Wood</button>
            <button class="frame-btn black-frame" data-frame="black" onclick="selectFrameCompact(this, 'lilac', 'black')" title="Black Frame">Black</button>
            <button class="frame-btn gold-frame" data-frame="gold" onclick="selectFrameCompact(this, 'lilac', 'gold')" title="Gold Frame">Gold</button>
            <button class="frame-btn white-frame" data-frame="white" onclick="selectFrameCompact(this, 'lilac', 'white')" title="White Frame">White</button>
            <button class="frame-btn silver-frame" data-frame="silver" onclick="selectFrameCompact(this, 'lilac', 'silver')" title="Silver Frame">Silver</button>
          </div>
          <button class="custom-ar-button pulse" onclick="activateAR(this)">View in AR</button>
        </div>
        <div class="artwork-info">
          <span class="ar-badge">AR Ready</span>
          <h3>Lilac</h3>
          <div class="artwork-meta">
            <span>Hand-painted on canvas</span>
            <span>28" x 38"</span>
          </div>
        </div>
        <div class="artwork-actions">
          <a href="https://www.32auctions.com/organizations/135580/auctions/194605/auction_items/6691643" target="_blank" rel="noopener" class="btn-bid" onclick="trackEvent('bid_click', 'Lilac')">Place a Bid</a>
        </div>
      </div>

      <!-- Revel -->
      <div class="artwork-card">
        <div class="artwork-card-wrapper" data-artwork-name="Revel" data-width-inches="28" data-height-inches="38">
          <model-viewer
            src="/models/charity/revel.glb"
            poster="/images/charity/shannon-thomas/revel.jpg"
            ar
            ar-modes="webxr scene-viewer quick-look"
            ar-scale="fixed"
            camera-controls
            touch-action="pan-y"
            shadow-intensity="0.3"
            exposure="1.1"
            loading="lazy"
            data-base-glb="/models/charity/revel.glb">
          </model-viewer>
          <div class="frame-selector-compact">
            <button class="frame-btn no-frame selected" data-frame="none" onclick="selectFrameCompact(this, 'revel', 'none')" title="No Frame"></button>
            <button class="frame-btn wood-frame" data-frame="wood" onclick="selectFrameCompact(this, 'revel', 'wood')" title="Wood Frame">Wood</button>
            <button class="frame-btn black-frame" data-frame="black" onclick="selectFrameCompact(this, 'revel', 'black')" title="Black Frame">Black</button>
            <button class="frame-btn gold-frame" data-frame="gold" onclick="selectFrameCompact(this, 'revel', 'gold')" title="Gold Frame">Gold</button>
            <button class="frame-btn white-frame" data-frame="white" onclick="selectFrameCompact(this, 'revel', 'white')" title="White Frame">White</button>
            <button class="frame-btn silver-frame" data-frame="silver" onclick="selectFrameCompact(this, 'revel', 'silver')" title="Silver Frame">Silver</button>
          </div>
          <button class="custom-ar-button pulse" onclick="activateAR(this)">View in AR</button>
        </div>
        <div class="artwork-info">
          <span class="ar-badge">AR Ready</span>
          <h3>Revel</h3>
          <div class="artwork-meta">
            <span>Hand-painted on canvas</span>
            <span>28" x 38"</span>
          </div>
        </div>
        <div class="artwork-actions">
          <a href="https://www.32auctions.com/organizations/135580/auctions/194605/auction_items/6691647" target="_blank" rel="noopener" class="btn-bid" onclick="trackEvent('bid_click', 'Revel')">Place a Bid</a>
        </div>
      </div>

      <!-- Roux -->
      <div class="artwork-card">
        <div class="artwork-card-wrapper" data-artwork-name="Roux" data-width-inches="28" data-height-inches="38">
          <model-viewer
            src="/models/charity/roux.glb"
            poster="/images/charity/shannon-thomas/roux.jpg"
            ar
            ar-modes="webxr scene-viewer quick-look"
            ar-scale="fixed"
            camera-controls
            touch-action="pan-y"
            shadow-intensity="0.3"
            exposure="1.1"
            loading="lazy"
            data-base-glb="/models/charity/roux.glb">
          </model-viewer>
          <div class="frame-selector-compact">
            <button class="frame-btn no-frame selected" data-frame="none" onclick="selectFrameCompact(this, 'roux', 'none')" title="No Frame"></button>
            <button class="frame-btn wood-frame" data-frame="wood" onclick="selectFrameCompact(this, 'roux', 'wood')" title="Wood Frame">Wood</button>
            <button class="frame-btn black-frame" data-frame="black" onclick="selectFrameCompact(this, 'roux', 'black')" title="Black Frame">Black</button>
            <button class="frame-btn gold-frame" data-frame="gold" onclick="selectFrameCompact(this, 'roux', 'gold')" title="Gold Frame">Gold</button>
            <button class="frame-btn white-frame" data-frame="white" onclick="selectFrameCompact(this, 'roux', 'white')" title="White Frame">White</button>
            <button class="frame-btn silver-frame" data-frame="silver" onclick="selectFrameCompact(this, 'roux', 'silver')" title="Silver Frame">Silver</button>
          </div>
          <button class="custom-ar-button pulse" onclick="activateAR(this)">View in AR</button>
        </div>
        <div class="artwork-info">
          <span class="ar-badge">AR Ready</span>
          <h3>Roux</h3>
          <div class="artwork-meta">
            <span>Hand-painted on canvas</span>
            <span>28" x 38"</span>
          </div>
        </div>
        <div class="artwork-actions">
          <a href="https://www.32auctions.com/organizations/135580/auctions/194605/auction_items/6691648" target="_blank" rel="noopener" class="btn-bid" onclick="trackEvent('bid_click', 'Roux')">Place a Bid</a>
        </div>
      </div>

      <!-- Vesper -->
      <div class="artwork-card">
        <div class="artwork-card-wrapper" data-artwork-name="Vesper" data-width-inches="28" data-height-inches="38">
          <model-viewer
            src="/models/charity/vesper.glb"
            poster="/images/charity/shannon-thomas/vesper.jpg"
            ar
            ar-modes="webxr scene-viewer quick-look"
            ar-scale="fixed"
            camera-controls
            touch-action="pan-y"
            shadow-intensity="0.3"
            exposure="1.1"
            loading="lazy"
            data-base-glb="/models/charity/vesper.glb">
          </model-viewer>
          <div class="frame-selector-compact">
            <button class="frame-btn no-frame selected" data-frame="none" onclick="selectFrameCompact(this, 'vesper', 'none')" title="No Frame"></button>
            <button class="frame-btn wood-frame" data-frame="wood" onclick="selectFrameCompact(this, 'vesper', 'wood')" title="Wood Frame">Wood</button>
            <button class="frame-btn black-frame" data-frame="black" onclick="selectFrameCompact(this, 'vesper', 'black')" title="Black Frame">Black</button>
            <button class="frame-btn gold-frame" data-frame="gold" onclick="selectFrameCompact(this, 'vesper', 'gold')" title="Gold Frame">Gold</button>
            <button class="frame-btn white-frame" data-frame="white" onclick="selectFrameCompact(this, 'vesper', 'white')" title="White Frame">White</button>
            <button class="frame-btn silver-frame" data-frame="silver" onclick="selectFrameCompact(this, 'vesper', 'silver')" title="Silver Frame">Silver</button>
          </div>
          <button class="custom-ar-button pulse" onclick="activateAR(this)">View in AR</button>
        </div>
        <div class="artwork-info">
          <span class="ar-badge">AR Ready</span>
          <h3>Vesper</h3>
          <div class="artwork-meta">
            <span>Hand-painted on canvas</span>
            <span>28" x 38"</span>
          </div>
        </div>
        <div class="artwork-actions">
          <a href="https://www.32auctions.com/organizations/135580/auctions/194605/auction_items/6691649" target="_blank" rel="noopener" class="btn-bid" onclick="trackEvent('bid_click', 'Vesper')">Place a Bid</a>
        </div>
      </div>

    </div>
  </div>

  <!-- CTA Section -->
  <section class="charity-cta">
    <h2>Support Son of a Saint</h2>
    <p>Every bid helps mentor fatherless boys in New Orleans.</p>
    <div class="cta-buttons">
      <a href="https://www.32auctions.com/organizations/135580/auctions/194605" target="_blank" rel="noopener" class="btn-primary" onclick="trackEvent('bid_click', 'cta_auction')">View Full Auction</a>
      <a href="https://sonofasaint.org" target="_blank" rel="noopener" class="btn-outline">Learn About Son of a Saint</a>
    </div>
  </section>

  <!-- Footer -->
  <footer class="public-footer">
    <p class="copyright">&copy; 2026 HiveMind AR.</p>
    <p class="hosted-by">Gallery hosted by <a href="/">HiveMind AR</a></p>
  </footer>

  <!-- Scripts -->
  <script type="module">
    import { supabase } from '/src/supabase.js';

    // ==========================================
    // Analytics Tracking
    // ==========================================

    // Visitor fingerprint (privacy-friendly, no PII)
    function getVisitorFingerprint() {
      let fp = localStorage.getItem('hm_charity_fp');
      if (!fp) {
        const raw = navigator.userAgent + screen.width + 'x' + screen.height + Intl.DateTimeFormat().resolvedOptions().timeZone;
        let hash = 0;
        for (let i = 0; i < raw.length; i++) {
          const char = raw.charCodeAt(i);
          hash = ((hash << 5) - hash) + char;
          hash |= 0;
        }
        fp = 'cf_' + Math.abs(hash).toString(36);
        localStorage.setItem('hm_charity_fp', fp);
      }
      return fp;
    }

    // Device type detection
    function getDeviceType() {
      const ua = navigator.userAgent;
      if (/tablet|ipad|playbook|silk/i.test(ua)) return 'tablet';
      if (/mobile|iphone|ipod|android|blackberry|opera mini|iemobile/i.test(ua)) return 'mobile';
      return 'desktop';
    }

    // Browser detection
    function getBrowser() {
      const ua = navigator.userAgent;
      if (ua.includes('Firefox/')) return 'Firefox';
      if (ua.includes('Edg/')) return 'Edge';
      if (ua.includes('Chrome/')) return 'Chrome';
      if (ua.includes('Safari/')) return 'Safari';
      return 'Other';
    }

    // Track analytics event
    async function trackEvent(eventType, artworkName) {
      try {
        if (!supabase) return;
        await supabase.from('charity_gallery_analytics').insert({
          gallery_id: 'shannon-thomas',
          event_type: eventType,
          artwork_name: artworkName || null,
          visitor_fingerprint: getVisitorFingerprint(),
          device_type: getDeviceType(),
          browser: getBrowser(),
          referrer: document.referrer || null
        });
      } catch (err) {
        console.log('Analytics error:', err);
      }
    }

    // Make trackEvent globally accessible for onclick handlers
    window.trackEvent = trackEvent;

    // Track page view (once per session)
    const viewedKey = 'viewed_charity_shannon_thomas';
    if (!sessionStorage.getItem(viewedKey)) {
      sessionStorage.setItem(viewedKey, 'true');
      trackEvent('page_view');
    }

    // Track artwork views via Intersection Observer
    const observer = new IntersectionObserver((entries) => {
      entries.forEach(entry => {
        if (entry.isIntersecting) {
          const wrapper = entry.target.closest('.artwork-card-wrapper');
          if (wrapper && !wrapper.dataset.viewed) {
            wrapper.dataset.viewed = 'true';
            const name = wrapper.dataset.artworkName;
            trackEvent('artwork_view', name);
          }
        }
      });
    }, { threshold: 0.5 });

    document.querySelectorAll('model-viewer').forEach(mv => {
      observer.observe(mv);
    });

    // ==========================================
    // Frame Generator (from artist.html pattern)
    // ==========================================

    class SimpleFrameGenerator {
      constructor() {
        this.frameCache = {};
      }

      async addFrameToImage(imageUrl, frameStyle) {
        const cacheKey = `${imageUrl}_${frameStyle}`;
        if (this.frameCache[cacheKey]) return this.frameCache[cacheKey];

        const img = await this.loadImage(imageUrl);
        const canvas = document.createElement('canvas');
        const ctx = canvas.getContext('2d');
        const frameThickness = Math.min(img.width, img.height) * 0.08;

        canvas.width = img.width + (frameThickness * 2);
        canvas.height = img.height + (frameThickness * 2);

        const style = this.getFrameStyle(frameStyle);

        ctx.fillStyle = style.color;
        ctx.fillRect(0, 0, canvas.width, canvas.height);

        if (style.pattern) {
          this.addFramePattern(ctx, canvas.width, canvas.height, style);
        }

        if (style.shadow) {
          ctx.shadowColor = 'rgba(0, 0, 0, 0.5)';
          ctx.shadowBlur = frameThickness * 0.3;
          ctx.shadowOffsetX = 0;
          ctx.shadowOffsetY = 0;
        }

        ctx.drawImage(img, frameThickness, frameThickness, img.width, img.height);
        this.addBevelEffect(ctx, frameThickness, canvas.width, canvas.height, style);

        const framedUrl = canvas.toDataURL('image/png');
        this.frameCache[cacheKey] = framedUrl;
        return framedUrl;
      }

      async loadImage(url) {
        try {
          const response = await fetch(url);
          const blob = await response.blob();
          const blobUrl = URL.createObjectURL(blob);
          return new Promise((resolve, reject) => {
            const img = new Image();
            img.onload = () => { URL.revokeObjectURL(blobUrl); resolve(img); };
            img.onerror = () => { URL.revokeObjectURL(blobUrl); reject(new Error('Load failed')); };
            img.src = blobUrl;
          });
        } catch {
          return new Promise((resolve, reject) => {
            const img = new Image();
            img.crossOrigin = 'anonymous';
            img.onload = () => resolve(img);
            img.onerror = () => reject(new Error('Load failed'));
            img.src = url;
          });
        }
      }

      getFrameStyle(style) {
        const styles = {
          wood: { color: '#8B4513', pattern: 'wood', shadow: true },
          black: { color: '#1a1a1a', pattern: null, shadow: true },
          gold: { color: '#C9A227', pattern: 'metallic', shadow: true },
          white: { color: '#f8f8f8', pattern: null, shadow: true },
          silver: { color: '#c0c0c0', pattern: 'metallic', shadow: true }
        };
        return styles[style] || { color: '#808080', pattern: null, shadow: false };
      }

      addFramePattern(ctx, width, height, style) {
        if (style.pattern === 'wood') {
          ctx.strokeStyle = 'rgba(0, 0, 0, 0.1)';
          ctx.lineWidth = 2;
          for (let i = 0; i < width; i += 20) {
            ctx.beginPath();
            ctx.moveTo(i, 0);
            ctx.lineTo(i + Math.random() * 10, height);
            ctx.stroke();
          }
        } else if (style.pattern === 'metallic') {
          const gradient = ctx.createLinearGradient(0, 0, width, height);
          gradient.addColorStop(0, 'rgba(255, 255, 255, 0.2)');
          gradient.addColorStop(0.5, 'rgba(255, 255, 255, 0)');
          gradient.addColorStop(1, 'rgba(255, 255, 255, 0.1)');
          ctx.fillStyle = gradient;
          ctx.fillRect(0, 0, width, height);
        }
      }

      addBevelEffect(ctx, frameThickness, width, height) {
        const bevelSize = frameThickness * 0.2;
        ctx.strokeStyle = 'rgba(255, 255, 255, 0.3)';
        ctx.lineWidth = bevelSize;
        ctx.strokeRect(bevelSize / 2, bevelSize / 2, width - bevelSize, height - bevelSize);
        ctx.strokeStyle = 'rgba(0, 0, 0, 0.3)';
        ctx.lineWidth = bevelSize;
        ctx.strokeRect(
          frameThickness - bevelSize / 2,
          frameThickness - bevelSize / 2,
          width - frameThickness * 2 + bevelSize,
          height - frameThickness * 2 + bevelSize
        );
      }

      async generateGLBFromImage(framedImageDataUrl, widthInches, heightInches) {
        const widthMeters = widthInches * 0.0254;
        const heightMeters = heightInches * 0.0254;

        const imageBase64 = framedImageDataUrl.split(',')[1];
        const imageBytes = atob(imageBase64);
        const imageBuffer = new Uint8Array(imageBytes.length);
        for (let i = 0; i < imageBytes.length; i++) {
          imageBuffer[i] = imageBytes.charCodeAt(i);
        }

        const positions = new Float32Array([
          -widthMeters/2, -heightMeters/2, 0,
          widthMeters/2, -heightMeters/2, 0,
          widthMeters/2, heightMeters/2, 0,
          -widthMeters/2, heightMeters/2, 0
        ]);
        const normals = new Float32Array([0,0,1, 0,0,1, 0,0,1, 0,0,1]);
        const texCoords = new Float32Array([0,1, 1,1, 1,0, 0,0]);
        const indices = new Uint16Array([0,1,2, 0,2,3]);

        const positionsBytes = new Uint8Array(positions.buffer);
        const normalsBytes = new Uint8Array(normals.buffer);
        const texCoordsBytes = new Uint8Array(texCoords.buffer);
        const indicesBytes = new Uint8Array(indices.buffer);

        let offset = 0;
        const positionsOffset = offset;
        offset += positionsBytes.length;
        while (offset % 4 !== 0) offset++;
        const normalsOffset = offset;
        offset += normalsBytes.length;
        while (offset % 4 !== 0) offset++;
        const texCoordsOffset = offset;
        offset += texCoordsBytes.length;
        while (offset % 4 !== 0) offset++;
        const indicesOffset = offset;
        offset += indicesBytes.length;
        while (offset % 4 !== 0) offset++;
        const imageOffset = offset;
        const totalBufferSize = imageOffset + imageBuffer.length;

        const combinedBuffer = new Uint8Array(totalBufferSize);
        combinedBuffer.set(positionsBytes, positionsOffset);
        combinedBuffer.set(normalsBytes, normalsOffset);
        combinedBuffer.set(texCoordsBytes, texCoordsOffset);
        combinedBuffer.set(indicesBytes, indicesOffset);
        combinedBuffer.set(imageBuffer, imageOffset);

        const gltf = {
          asset: { version: "2.0" },
          scene: 0,
          scenes: [{ nodes: [0] }],
          nodes: [{ mesh: 0 }],
          meshes: [{ primitives: [{ attributes: { POSITION: 0, NORMAL: 1, TEXCOORD_0: 2 }, indices: 3, material: 0 }] }],
          materials: [{ pbrMetallicRoughness: { baseColorTexture: { index: 0 }, metallicFactor: 0, roughnessFactor: 1 }, doubleSided: true }],
          textures: [{ source: 0 }],
          images: [{ mimeType: "image/png", bufferView: 4 }],
          accessors: [
            { bufferView: 0, componentType: 5126, count: 4, type: "VEC3", max: [widthMeters/2, heightMeters/2, 0], min: [-widthMeters/2, -heightMeters/2, 0] },
            { bufferView: 1, componentType: 5126, count: 4, type: "VEC3" },
            { bufferView: 2, componentType: 5126, count: 4, type: "VEC2" },
            { bufferView: 3, componentType: 5123, count: 6, type: "SCALAR" }
          ],
          bufferViews: [
            { buffer: 0, byteOffset: positionsOffset, byteLength: positionsBytes.length },
            { buffer: 0, byteOffset: normalsOffset, byteLength: normalsBytes.length },
            { buffer: 0, byteOffset: texCoordsOffset, byteLength: texCoordsBytes.length },
            { buffer: 0, byteOffset: indicesOffset, byteLength: indicesBytes.length },
            { buffer: 0, byteOffset: imageOffset, byteLength: imageBuffer.length }
          ],
          buffers: [{ byteLength: totalBufferSize }]
        };

        const gltfJson = JSON.stringify(gltf);
        const gltfJsonBytes = new TextEncoder().encode(gltfJson);
        const gltfJsonPadded = new Uint8Array(Math.ceil(gltfJsonBytes.length / 4) * 4);
        gltfJsonPadded.set(gltfJsonBytes);
        for (let i = gltfJsonBytes.length; i < gltfJsonPadded.length; i++) {
          gltfJsonPadded[i] = 0x20;
        }

        const headerSize = 12;
        const jsonChunkHeader = 8;
        const binChunkHeader = 8;
        const totalSize = headerSize + jsonChunkHeader + gltfJsonPadded.length + binChunkHeader + combinedBuffer.length;

        const glb = new Uint8Array(totalSize);
        const view = new DataView(glb.buffer);
        view.setUint32(0, 0x46546C67, true);
        view.setUint32(4, 2, true);
        view.setUint32(8, totalSize, true);

        let off2 = 12;
        view.setUint32(off2, gltfJsonPadded.length, true);
        view.setUint32(off2 + 4, 0x4E4F534A, true);
        glb.set(gltfJsonPadded, off2 + 8);

        off2 += 8 + gltfJsonPadded.length;
        view.setUint32(off2, combinedBuffer.length, true);
        view.setUint32(off2 + 4, 0x004E4942, true);
        glb.set(combinedBuffer, off2 + 8);

        const blob = new Blob([glb], { type: 'model/gltf-binary' });
        return URL.createObjectURL(blob);
      }
    }

    const frameGenerator = new SimpleFrameGenerator();
    window.frameGenerator = frameGenerator;

    // Frame selection state
    const artworkFrameSelections = {};
    const originalPosters = {};
    const originalGLBs = {};
    const framedGLBs = {};

    // ==========================================
    // Frame Selector Logic
    // ==========================================

    window.selectFrameCompact = async function(button, artworkId, frameType) {
      const wrapper = button.closest('.artwork-card-wrapper');
      wrapper.querySelectorAll('.frame-btn').forEach(btn => btn.classList.remove('selected'));
      button.classList.add('selected');
      artworkFrameSelections[artworkId] = frameType;

      const modelViewer = wrapper.querySelector('model-viewer');

      if (!originalPosters[artworkId]) {
        originalPosters[artworkId] = modelViewer.getAttribute('poster');
      }
      if (!originalGLBs[artworkId]) {
        originalGLBs[artworkId] = modelViewer.getAttribute('src');
      }

      if (frameType === 'none') {
        modelViewer.setAttribute('poster', originalPosters[artworkId]);
        modelViewer.setAttribute('src', originalGLBs[artworkId]);
      } else {
        try {
          button.style.opacity = '0.5';
          const imageSource = originalPosters[artworkId];
          const framedImageUrl = await window.frameGenerator.addFrameToImage(imageSource, frameType);
          modelViewer.setAttribute('poster', framedImageUrl);

          const widthInches = parseFloat(wrapper.getAttribute('data-width-inches')) || 28;
          const heightInches = parseFloat(wrapper.getAttribute('data-height-inches')) || 38;

          const cacheKey = `${artworkId}_${frameType}`;
          if (!framedGLBs[cacheKey]) {
            framedGLBs[cacheKey] = await window.frameGenerator.generateGLBFromImage(framedImageUrl, widthInches, heightInches);
          }
          modelViewer.setAttribute('src', framedGLBs[cacheKey]);
          button.style.opacity = '1';

          const notification = document.createElement('div');
          notification.textContent = `${frameType.charAt(0).toUpperCase() + frameType.slice(1)} frame applied!`;
          notification.style.cssText = 'position: fixed; top: 20px; left: 50%; transform: translateX(-50%); background: rgba(128, 60, 180, 0.95); color: white; padding: 12px 24px; border-radius: 8px; z-index: 10000; font-size: 14px;';
          document.body.appendChild(notification);
          setTimeout(() => notification.remove(), 2000);
        } catch (err) {
          console.error('Frame generation failed:', err);
          button.style.opacity = '1';
          artworkFrameSelections[artworkId] = 'none';
          button.classList.remove('selected');
          wrapper.querySelector('.frame-btn.no-frame').classList.add('selected');
          modelViewer.setAttribute('poster', originalPosters[artworkId]);
          modelViewer.setAttribute('src', originalGLBs[artworkId]);
        }
      }

      event?.stopPropagation();
      return false;
    };

    // ==========================================
    // AR Activation
    // ==========================================

    function isMobileDevice() {
      return /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent) ||
             (navigator.platform === 'MacIntel' && navigator.maxTouchPoints > 1);
    }

    function isInAppBrowser() {
      const ua = navigator.userAgent || navigator.vendor || window.opera;
      return /FBAN|FBAV|Instagram|Twitter|LinkedInApp|Snapchat|Line\//i.test(ua);
    }

    function showInAppBrowserBanner() {
      if (!isInAppBrowser()) return;
      const banner = document.createElement('div');
      banner.innerHTML = `
        <div style="position: fixed; bottom: 0; left: 0; right: 0; background: linear-gradient(135deg, #803cb4 0%, #6a2c9a 100%); color: white; padding: 16px 20px; z-index: 10000; text-align: center; font-size: 14px; box-shadow: 0 -4px 20px rgba(0,0,0,0.2);">
          <div style="margin-bottom: 10px;"><strong>AR works best in Safari</strong></div>
          <div style="margin-bottom: 12px; opacity: 0.9;">Tap below to open this gallery in Safari for the full AR experience</div>
          <button onclick="openInSafari()" style="background: white; color: #803cb4; border: none; padding: 12px 24px; border-radius: 8px; font-weight: 600; cursor: pointer; margin-right: 10px;">Open in Safari</button>
          <button onclick="this.parentElement.parentElement.remove()" style="background: transparent; color: white; border: 1px solid rgba(255,255,255,0.5); padding: 12px 24px; border-radius: 8px; cursor: pointer;">Dismiss</button>
        </div>
      `;
      document.body.appendChild(banner);
    }

    window.openInSafari = function() {
      const currentUrl = window.location.href;
      if (navigator.clipboard) {
        navigator.clipboard.writeText(currentUrl).then(() => {
          alert('Link copied!\n\nOpen Safari and paste the link to view AR.');
        }).catch(() => {
          prompt('Copy this link and paste it in Safari:', currentUrl);
        });
      } else {
        prompt('Copy this link and paste it in Safari:', currentUrl);
      }
    };

    function setupArButtons() {
      const arButtons = document.querySelectorAll('.custom-ar-button');
      const isDesktop = !isMobileDevice();
      arButtons.forEach(button => {
        if (isDesktop) {
          button.classList.add('desktop-mode');
          button.innerHTML = 'View in AR <span class="ar-desktop-tooltip">Open this page on your phone to use AR</span>';
        }
      });
    }

    window.activateAR = function(button) {
      const wrapper = button.closest('.artwork-card-wrapper');
      const modelViewer = wrapper.querySelector('model-viewer');
      const artworkName = wrapper.getAttribute('data-artwork-name');

      if (!isMobileDevice()) {
        const currentUrl = window.location.href;
        const message = `AR viewing requires a mobile device.\n\nOpen this link on your phone:\n${currentUrl}`;
        if (navigator.clipboard) {
          navigator.clipboard.writeText(currentUrl).then(() => {
            alert(message + '\n\n(Link copied to clipboard!)');
          }).catch(() => { alert(message); });
        } else {
          alert(message);
        }
        return false;
      }

      if (modelViewer && modelViewer.tagName === 'MODEL-VIEWER') {
        trackEvent('ar_view', artworkName);

        if (!modelViewer.loaded) {
          const originalText = button.textContent;
          button.textContent = 'Loading AR...';
          button.disabled = true;
          modelViewer.addEventListener('load', function onLoad() {
            modelViewer.removeEventListener('load', onLoad);
            button.textContent = originalText;
            button.disabled = false;
            try { modelViewer.activateAR(); } catch(err) {
              console.error('AR activation failed:', err);
              alert('AR activation failed. Please try again.');
            }
          }, { once: true });
          setTimeout(() => {
            if (!modelViewer.loaded) {
              button.textContent = originalText;
              button.disabled = false;
              alert('Model is taking too long to load. Please wait and try again.');
            }
          }, 15000);
          return false;
        }

        try { modelViewer.activateAR(); } catch(err) {
          console.error('AR activation failed:', err);
          alert('AR activation failed. Please try again.');
        }
        return false;
      }
    };

    // Error handler for model-viewers
    document.querySelectorAll('model-viewer').forEach(mv => {
      mv.addEventListener('error', () => {
        const wrapper = mv.closest('.artwork-card-wrapper');
        if (wrapper) {
          const arButton = wrapper.querySelector('.custom-ar-button');
          if (arButton) arButton.style.display = 'none';
          const frameSelector = wrapper.querySelector('.frame-selector-compact');
          if (frameSelector) frameSelector.style.display = 'none';
        }
        const card = mv.closest('.artwork-card');
        if (card) {
          const arBadge = card.querySelector('.ar-badge');
          if (arBadge) arBadge.style.display = 'none';
        }
      });
    });

    // Initialize
    setupArButtons();
    showInAppBrowserBanner();
  </script>

  <!-- Mobile Nav Toggle -->
  <script>
    function toggleMobileNav() {
      const navLinks = document.getElementById('navLinks');
      navLinks.classList.toggle('active');
    }
    document.addEventListener('DOMContentLoaded', function() {
      document.querySelectorAll('.nav-links a').forEach(link => {
        link.addEventListener('click', () => {
          document.getElementById('navLinks').classList.remove('active');
        });
      });
    });
  </script>

  <!-- Cookie Consent -->
  <script src="/scripts/cookie-consent.js"></script>
</body>
</html>
